stages:
  split_data:
    cmd: python -m src.data.split_dataset --splits_dir data/splits
    deps:
      - src/data/split_dataset.py
      - data/raw/Fake.csv
      - data/raw/True.csv
    outs:
      - data/splits

  preprocess_v1:
    cmd: python -m src.data.preprocess --version v1 --input_dir data/splits --output_dir data/processed/v1
    deps:
      - src/data/preprocess.py
      - data/splits
    outs:
      - data/processed/v1

  preprocess_v2:
    cmd: python -m src.data.preprocess --version v2 --input_dir data/splits --output_dir data/processed/v2
    deps:
      - src/data/preprocess.py
      - data/splits
    outs:
      - data/processed/v2

  train_model:
    cmd: python -m src.models.train --config configs/train.yaml
    deps:
      - src/models/train.py
      - src/features/build_features.py
      - configs/train.yaml
      - data/processed/v1
      - data/processed/v2
    outs:
      - models
    metrics:
      - metrics.json
    params:
      - configs/train.yaml:
          - data.version
          - features.type
          - features.tfidf.max_features
          - features.tfidf.ngram_range
          - features.tfidf.min_df
          - model.name
          - model.logreg.C
          - model.logreg.max_iter
          - model.rf.n_estimators
          - model.rf.max_depth
          - train.random_state
          - output.run_name
